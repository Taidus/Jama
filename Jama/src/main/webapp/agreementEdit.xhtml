<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:sections="http://java.sun.com/jsf/composite/sections"
	xmlns:dialogs="http://java.sun.com/jsf/composite/dialogs">

<h:head>
	<h:outputStylesheet name="agreementWiz.css" library="css" />
</h:head>
<h:body>

	<h:form id="agreementEdit">

		<input type="hidden" name="cid"
			value='#{agreementManager.conversation.id}' />

		<p:tabView activeIndex="#{agreementEditPB.currentTabIndex}"
			>
			<p:ajax event="tabChange" listener="#{agreementEditPB.handleFlow}"></p:ajax>

			<p:tab id="tabDati" title="Dati">
				<sections:agreementWizData editingDisable="false"  />

			</p:tab>


			<p:tab id="tabRip" title="Passo 2">
				<sections:wizShareTable editingDisable="false" agreementTable="true"
					bean="#{agreementShareTablePCB}" />
			</p:tab>

			<p:tab id="tabInstallments" title="Passo 3">
				<sections:agreementInstallmentsList installmentOutcome="agreementEdit">
				</sections:agreementInstallmentsList>


			</p:tab>

			<ui:include src="/resources/sections/agreementWizAttachments.xhtml" />


		</p:tabView>


		<p:commandButton type="button" value="#{msgs.cancel}"
			onclick="w_confirm.show();" />

		<p:confirmDialog message="#{msgs.sure}" header="#{msgs.cancel}"
			severity="alert" widgetVar="w_confirm">
			<p:commandButton value="#{msgs.yes}"
				action="#{agreementEditPB.cancel()}"
				actionListener="#{agreementShareTablePCB.toUpdate()}"
				immediate="true" oncomplete="w_confirm.hide()" />
			<p:commandButton value="#{msgs.no}" onclick="w_confirm.hide();"
				type="button" />
		</p:confirmDialog>

		<p:commandButton value="#{msgs.save}"
			action="#{agreementEditPB.save()}"
			actionListener="#{agreementShareTablePCB.toUpdate()}" ajax="false" />



	</h:form>




	<dialogs:chiefDialog name="w_chiefDialog"></dialogs:chiefDialog>

	<dialogs:companyDialog name="w_companyDialog">
	</dialogs:companyDialog>

	<dialogs:personnelShareDialog name="w_personnelShare"></dialogs:personnelShareDialog>


</h:body>
</html>