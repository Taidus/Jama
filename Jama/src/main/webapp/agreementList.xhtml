<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<h:head></h:head>
<h:body>

	<h:form>
		<input type="hidden" name="cid"
				value='#{agreementListPB.conversation.id}' />
				
		<p:contextMenu for="agreementTable">  
	        <p:menuitem value="#{msgs.view}" outcome="done" icon="ui-icon-search" />  
	        <p:menuitem value="#{msgs.edit}" outcome="cancel" icon="ui-icon-edit"/>  
	    </p:contextMenu> 

		<p:dataTable id="agreementTable" var="agr" widgetVar="w_agrTable" lazy="true" 
			value="#{agreementListPB.lazyModel}" emptyMessage="#{msgs.noAgrFound}"
			paginator="true" rows="10" rowsPerPageTemplate="5,10,15" 
			paginatorTemplate="{RowsPerPageDropdown} {PreviousPageLink} {NextPageLink}"
			selection="#{agreementListPB.selectedValue}" selectionMode="single" rowKey="#{agr.id}">

			<ui:remove>
			<f:facet name="header">
				<p:outputPanel>
					<h:outputText value="#{msgs.search}:" />
					<p:inputText id="globalFilter" onkeyup="w_agrTable.filter()"
						style="width:150px" />
				</p:outputPanel>
			</f:facet>
			</ui:remove>

			<p:column id="chiefColumn" filterBy="#{agr.chief.id}"
				headerText="#{msgs.chief}" filterMatchMode="exact"
				filterOptions="#{utilPB.filterChiefItems}">
				<h:outputText value="#{agr.chief.completeName}" />
			</p:column>

			<p:column id="companyColumn" filterBy="#{agr.company.id}"
				headerText="#{msgs.company}" filterMatchMode="exact"
				filterOptions="#{utilPB.filterCompanyItems}">
				<h:outputText value="#{agr.company.name}" />
			</p:column>

			<p:column id="dateColumn">
				<f:facet name="header">
	                	#{msgs.approvalDate}  
					<h:form id="calendarFilters">
					    <div style="display: block; width: 90%; margin: auto;">
							<p:calendar id="firstDate" styleClass="calendarFilter" widgetVar="w_firstDate"
								value="#{agreementListPB.lazyModel.filterMinDate}" pattern="dd/MM/yyyy"
								readonlyInput="true" showOn="both" showOtherMonths="true">
							</p:calendar>
							-
							<p:calendar id="lastDate" styleClass="calendarFilter" widgetVar="w_lastDate"
								value="#{agreementListPB.lazyModel.filterMaxDate}" pattern="dd/MM/yyyy"
								readonlyInput="true" showOn="both" showOtherMonths="true">
							</p:calendar>
						</div>
						<p:commandButton value="#{msgs.filter}" onclick="w_agrTable.filter()" />
						<p:commandButton value="#{msgs.reset}" onclick="w_firstDate.setDate(null); w_lastDate.setDate(null);" />
					</h:form>
				</f:facet>
				
				<h:outputText value="#{agr.approvalDate}" />
			</p:column>

		</p:dataTable>
		
		<h:commandButton action="#{agreementListPB.backToHome()}" value="Home" immediate="true"/> 

	</h:form>
	
	
</h:body>
</html>